<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Favorites | Travel Planner</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(45deg, #8e24aa, #6a1b9a);
            min-height: 100vh;
            color: white;
            text-transform: capitalize;
        }

        /* Navbar */
        .navbar {
            background-color: #6a1b9a !important;
            /* Deep Purple */
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 0.8rem 1rem;
        }

        .navbar-brand {
            color: #ffffff !important;
            font-weight: 700;
            font-size: 1.6rem;
            display: flex;
            align-items: center;
        }

        .navbar-brand i {
            margin-right: 8px;
            font-size: 1.8rem;
            color: #ffeb3b;
            /* Accent color for icon */
        }

        .nav-link {
            color: #e0e0e0 !important;
            font-weight: 500;
            margin-right: 15px;
            transition: color 0.3s ease, transform 0.2s ease;
            font-size: 1.05rem;
            display: flex;
            align-items: center;
        }

        .nav-link i {
            margin-right: 6px;
            font-size: 1.1rem;
        }

        .nav-link:hover {
            color: #ffffff !important;
            transform: translateY(-2px);
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
        }
        #username{
            color: #ffffff;
            font-weight: bold;
            font-family:'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;
        }

        .card {
            background-color: #fff;
            color: #333;
            border-radius: 15px;
            padding: 2rem;
            max-width: 500px;
            margin: auto;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        }

        .card-header {
            text-align: center;
            margin-bottom: 1rem;
        }

        .card-header svg {
            color: #6a1b9a;
        }

        .nav-tabs .nav-link.active {
            background-color: #6a1b9a;
            color: white;
            border-radius: 25px;
        }

        /* Main Content */
        .page-header {
            text-align: center;
            padding: 3rem 1rem;
        }

        .page-header h1 {
            font-weight: 700;
        }

        .page-header i {
            color: #ffeb3b;
        }

        /* Favorites Container */
        .favorites-container {
            background: white;
            color: #333;
            border-radius: 12px;
            max-width: 1200px;
            margin: 2rem auto;
            padding: 2rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .favorites-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            color: #444;
        }

        .favorites-header h4 i {
            color: #6a1b9a;
        }

        /* Favorite Cards */
        .fav-card {
            border: none;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .fav-card:hover {
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        .fav-card-img {
            height: 160px;
            object-fit: cover;
        }

        .remove-btn {
            position: absolute;
            top: 12px;
            right: 12px;
            background: rgba(255, 255, 255, 0.8);
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #f44336;
            cursor: pointer;
        }

        .card-body h5 {
            color: #6a1b9a;
        }

        .meta-info {
            color: #6c757d;
            font-size: 0.85rem;
        }

        .badge-category {
            background: #6a1b9a;
            color: white;
        }

        /* Buttons */
        .btn-primary {
            background: #6a1b9a;
            border: none;
        }

        .btn-outline-danger {
            color: #f44336;
            border-color: #f44336;
        }

        .btn-explore {
            background: linear-gradient(45deg, #8e24aa, #6a1b9a);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 0.6rem 2rem;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(107, 66, 193, 0.3);
        }

        /* Empty State */
        .no-favorites {
            text-align: center;
            padding: 3rem;
        }

        .no-favorites i {
            font-size: 3.5rem;
            color: #888;
        }

        @media (max-width: 768px) {
            .favorites-header {
                flex-direction: column;
                gap: 1rem;
                align-items: flex-start;
            }
        }
    </style>
</head>

<body>
    
    <nav class="navbar navbar-expand-lg">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="bi bi-geo-alt-fill"></i> Travel Planner
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#collapsibleNavId"
                aria-controls="collapsibleNavId" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="collapsibleNavId">
                <ul class="navbar-nav me-auto mt-2 mt-lg-0">
                    <li class="nav-item">
                        <a class="nav-link" href="home.html"><i class="bi bi-house-door-fill"></i> Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="destinations.html"><i class="bi bi-map"></i> Destinations</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="my-trips.html"><i class="bi bi-calendar-check-fill"></i> My Trips</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#"><i class="bi bi-heart-fill"></i> Favourites</a>
                    </li>
                </ul>
                <form class="d-flex my-2 my-lg-0">
                    <biv id="username"></biv>
                </form>
            </div>
        </div>
    </nav>

    
    <header class="page-header">
        <h1><i class="bi bi-heart-fill"></i> My Favorites</h1>
        <p>Save and organize your favorite destinations and trips</p>
    </header>

    
    <main class="favorites-container">
        <div class="favorites-header">
            <h4><i class="bi bi-heart-fill"></i> Saved Favorites</h4>
            <div>
                <button id="addSampleBtn" class="btn btn-primary btn-sm">
                    <i class="bi bi-plus-lg"></i> Add Sample
                </button>
                <button id="clearAllBtn" class="btn btn-outline-danger btn-sm ms-2">
                    <i class="bi bi-trash"></i> Clear All
                </button>
            </div>
        </div>

        <div id="favoritesList" class="row g-3"></div>

        <div id="noFavoritesMessage" class="no-favorites">
            <i class="bi bi-heart" style="font-size: 3.5rem;"></i>
            <h3 class="mt-3">No favorites yet</h3>
            <p>Start exploring destinations and add them to your favorites to see them here.</p>
            <button id="exploreBtn" class="btn btn-explore mt-3">
                <i class="bi bi-search me-2"></i>Explore Destinations
            </button>
        </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        
        let favoriteIDs = [];
        let apiData = null;

        
        const favoritesList = document.getElementById('favoritesList');
        const noFavoritesMessage = document.getElementById('noFavoritesMessage');
        const clearAllBtn = document.getElementById('clearAllBtn');
        const addSampleBtn = document.getElementById('addSampleBtn');
        const exploreBtn = document.getElementById('exploreBtn');

        
        function loadFavorites() {
            const favorites = localStorage.getItem('favorites');
            return favorites ? JSON.parse(favorites) : [];
        }

        
        function saveFavorites(ids) {
            localStorage.setItem('favorites', JSON.stringify(ids));
        }

        
        async function fetchData() {
            try {
                const response = await fetch('https://edu-me01.github.io/Traval-task/api/data.json');
                apiData = await response.json();
            } catch (error) {
                console.error('Error fetching data:', error);
            }
        }

        
        function getItemById(id) {
            if (!apiData?.destinations) return null;
            return apiData.destinations.find(item => item.id === id);
        }

        
        function renderFavorites() {
            favoritesList.innerHTML = '';
            favoriteIDs = loadFavorites();

            if (favoriteIDs.length === 0) {
                noFavoritesMessage.classList.remove('d-none');
                return;
            }

            noFavoritesMessage.classList.add('d-none');

            favoriteIDs.forEach(id => {
                const item = getItemById(id);
                if (!item) return;

                const col = document.createElement('div');
                col.className = 'col-md-6 col-lg-4 col-xl-3';

                col.innerHTML = `
          <div class="fav-card">
            <img src="${item.image}" class="fav-card-img w-100" alt="${item.country}">
            <button class="remove-btn" onclick="removeFavorite(${id})">
              <i class="bi bi-x-lg"></i>
            </button>
            <div class="card-body">
              <h5>${item.country}</h5>
              <p class="card-text">${item.description?.slice(0, 100)}...</p>
              <div class="meta-info d-flex justify-content-between">
                <small><i class="bi bi-geo-alt"></i> ${item.region}</small>
                <span class="badge badge-category">${item.population}</span>
              </div>
              <button class="btn btn-sm btn-primary w-100 mt-2" onclick="viewDestination(${id})">
                View Details
              </button>
            </div>
          </div>
        `;

                favoritesList.appendChild(col);
            });
        }

        
        function removeFavorite(id) {
            if (confirm('Remove this favorite?')) {
                favoriteIDs = favoriteIDs.filter(itemId => itemId !== id);
                saveFavorites(favoriteIDs);
                renderFavorites();
            }
        }

        
        function clearAllFavorites() {
            if (confirm('Clear all favorites?')) {
                favoriteIDs = [];
                saveFavorites(favoriteIDs);
                renderFavorites();
            }
        }

        
        function addSampleFavorites() {
            if (!apiData?.destinations) return;

            const sampleIds = apiData.destinations.slice(0, 4).map(item => item.id);
            favoriteIDs = [...new Set([...favoriteIDs, ...sampleIds])];
            saveFavorites(favoriteIDs);
            renderFavorites();
        }

        
        function viewDestination(id) {
            localStorage.setItem('selectedDestinationId', id);
            window.location.href = 'cardsDetails.html';
        }

        (async () => {
            await fetchData();
            renderFavorites();

            
            clearAllBtn.addEventListener('click', clearAllFavorites);
            addSampleBtn.addEventListener('click', addSampleFavorites);
            exploreBtn.addEventListener('click', () => {
                window.location.href = 'destinations.html';
            });
        })();

        async function loadUsername() {
        const email = localStorage.getItem("email");

        if (!email) return;

        try {
            const res = await fetch('https://edu-me01.github.io/Traval-task/api/data.json');
            const data = await res.json();

            const user = data.users?.find(u => u.email === email);

            if (user) {
                document.getElementById("username").innerHTML = `Welcome, ${user.name}`;
            } else {
                console.warn("User not found");
            }
        } catch (error) {
            console.error("Error loading user:", error);
        }
    }

    loadUsername();
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
</body>

</html>
